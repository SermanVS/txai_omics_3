# Детектирование и построение состязательных примеров, поиск аномалий во входных данных и экспертная оценка модели 
## Общие сведения

Репозиторий с исходным кодом моделей, разрабатываемых в рамках 
четвертого этапа научно-исследовательской работы по теме «Приложение методов доверенного и объяснимого искусственного 
интеллекта к анализу омикс-данных».

## Подготовка окружения

```bash
# clone project
cd <project directory>

# [OPTIONAL] create conda environment
conda create -n env_name python=3.11
conda activate env_name

# install pytorch according to instructions
# https://pytorch.org/get-started/

# install requirements
pip install -r requirements.txt
```

## Описание данных и экспериментов
Исследуются данные двух типов: эпигенетические и иммунологические данные.

### Эпигенетические данные
Данные метилирования ДНК цельной крови человека из репозитория [GEO](https://www.ncbi.nlm.nih.gov/geo/) со следующими условиями: крупнейшие наборы данных, которые включают как пациентов с болезнью Паркинсона, так и контрольную группу, при этом в каждой группе не менее 50 семплов.
Наборы данных GSE145361 и GSE111629 были выбраны в качестве тренировочно-валидационного набора данных, GSE72774 - в качестве тестового.
Всего 2968 семплов (2460 в тренировочно-валидационной выборке и 508 в тестовой).
Для построения моделей использовались 1000 наиболее важных признаков - CpG-сайтов.
Обученные в рамках второго этапа модели решают задачи классификации Cases (болезнь Паркинсона) vs Controls (здоровые) по данным отобранных признаков (CpG-сайтов).

### Иммунологические данные
Данные иммунологического профиля представляют из себя значения концентраций 10 наиболее значимых цитокинов в плазме крови для 300 человек (260 человек - тренировочно-валидационная выборка и 40 человек - тестовая).
Обученные в рамках второго этапа модели решают задачи регрессии хронологического возраста по данным иммунологии.


## Файловая структура
Корневая директория пакета содержит данные согласно иерархии:
```
└── data                            <- Общая директория с данными
    ├── dnam                           <- Эпигенетические данные
    │   ├── model.ckpt                    <- Обученная в рамках второго этапа модель
    │   ├── betas.xlsx                    <- Датасет
    │   ├── feats.xlsx                    <- Файл с указанием входных признаков
    │   └── classes.xlsx                  <- Файл с указанием классов
    └── immuno                         <- Иммунологические данные
        ├── model.ckpt                    <- Обученная в рамках второго этапа модель
        ├── shap.pickle                   <- SHAP-значения
        ├── data.xlsx                     <- Датасет
        └── feats.xlsx                    <- Файл с указанием входных признаков
└── txai_omics_3                   <- Общая директория с исходным кодом
    ├── datamodules                    <- Эпигенетические данные
    │   ├── cross_validation.py           
    │   └── tabular.py                    
    └── models                         <- Модели предсказания биологического возраста
        └── tabular                       <- Табулярные модели
            └── widedeep                     <- Модели архитектуры widedeep
            │    ├── base.py                    <- Базовая модель widedeep
            │    └── ft_transformer.py          <- Модель FTTransformer
            └── base.py                   <- Базовая табулярная модель
    └── tasks                          <- Задачи
        ├── classification                <- Директория с задачами классификации
        ├── regression                    <- Директория с задачами регрессии
        ├── metrics.py                    <- Метрики
        └── routines.py                   <- Рутины
```
